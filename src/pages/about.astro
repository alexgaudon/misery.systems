---
import { getRuntimeEnv } from "../lib/runtimeEnv";
import Layout from "./layout.astro";
const runtimeEnv = getRuntimeEnv();

// Map node names to their positions in the rack (percentage from top)
// Based on the rack image: GRIEF, DESPAIR, BLEAK, SORROW, GLOOM (top to bottom)
const nodePositions: Record<string, number> = {
    "k8s-master-1": 44,  // GRIEF (top HP server)
    "k8s-master-2": 57,  // DESPAIR (second HP server)
    "k8s-worker-1": 70,  // BLEAK (first ThinkCentre)
    "k8s-worker-2": 78,  // SORROW (second ThinkCentre)
    "k8s-worker-3": 87,  // GLOOM (third ThinkCentre)
};

const topPosition = runtimeEnv.nodeName ? nodePositions[runtimeEnv.nodeName] : 50;
---

<Layout>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
            <h1 class="text-2xl font-semibold mb-2">About</h1>
            <p class="text-lg mb-4">
                <b>misery.systems</b> is just my homelab.
            </p>
            <p class="text-lg mb-4">
                I run random stuff here and mess with kubernetes and linux.
            </p>
            <p class="text-lg mb-4">
                It's mostly for learning, breaking things, and fixing them (sometimes).
            </p>
        </div>
        <div class="relative">
            <img src="/rack-min.jpg" alt="Homelab" class="w-full rounded shadow-md" style="aspect-ratio: 1968 / 3485;" loading="eager" fetchpriority="high" />
            {runtimeEnv.nodeName && (
                <div 
                    class="absolute left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-yellow-400 text-black px-3 py-2 rounded-lg shadow-lg font-bold text-sm sm:text-base border-2 border-black"
                    style={`top: ${topPosition}%;`}
                >
                    &larr; You are here &rarr;
                </div>
            )}
        </div>
    </div>
</Layout>